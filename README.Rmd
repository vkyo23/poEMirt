---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  warning = FALSE,
  message = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# poEMirt

<!-- badges: start -->
[![R-CMD-check](https://github.com/vkyo23/poEMirt/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/vkyo23/poEMirt/actions/workflows/R-CMD-check.yaml)
<!-- badges: end -->

`poEMirt` is an `R` package that implements fast EM item response theory models for public opinion data analysis. 
Models can be applied to binary, categorical, binomial and multinomial outcome data. Users can also estimate statistical uncertainty by parametric bootstrap and Gibbs Sampling.

## Installation

You can install the development version of `poEMirt` from [GitHub](https://github.com) with: 

```{r, eval=FALSE}
remotes::install_github("vkyo23/poEMirt")
```

## Usage

### Multinomial outcome

```{r}
library(poEMirt)
data("sim_data_dynamic")

head(sim_data_dynamic)
tail(sim_data_dynamic)

# Convert into poEMirt-readable data
data <- read_poEMirt(
  data = sim_data_dynamic,
  responses = paste0('y', 1:5),
  i = "i",
  j = "j",
  t = "t"
)
summary(data)

# Fit the model
fit <- poEMirt(
  data = data,
  model = "dynamic",
  control = list(
    verbose = 10
  )
)

# Summarize the result
summary(fit, parameter = "theta")
```

### Estimation of statistical uncertainty

To estimate statistical uncertainty (e.g., standard deviation), you can use `poEMirt_uncertainty()`. In this function, you can choose *parametric bootstrap* (`"bootstrap"`) or *Gibbs sampling* (`"gibbs"`).

#### Bootstrap

```{r}
fit_boot <- poEMirt_uncertainty(
  fit = fit,
  method = "bootstrap",
  seed = 1,
  iter = 100,
  control = list(
    verbose = 10
  )
)

summary(fit_boot, parameter = "theta", ci = 0.95)
```

```{r, include=FALSE}
rm(list = "fit_boot")
gc(reset = TRUE); gc(reset = TRUE)
```


#### Gibbs Sampling

Using EM estimates as starting values of Gibbs sampler.

```{r}
fit_gibbs <- poEMirt_uncertainty(
  fit = fit,
  method = "gibbs",
  seed = 1,
  iter = 500,
  control = list(
    verbose = 50,
    warmup = 100,
    thin = 5
  )
)

summary(fit_gibbs, parameter = "theta", ci = 0.95)
```

